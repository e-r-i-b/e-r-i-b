<?xml version="1.0" encoding="windows-1251"?>

<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../../../Settings/schemas/state-machine.xsd">

	<states description="Машина состояний шаблона поручения на перевод/прием перевода ценных бумаг" name="SecuritiesTransferClaim"
            inital-state="DRAFTTEMPLATE">

        <state id="DRAFTTEMPLATE" description="Неполностью заполненный шаблон"
               client-form="/private/payments/template.do"
               system-resolver="com.rssl.phizic.business.payments.ERIBSystemNameResolver">

            <events>
                <event name="EDIT_TEMPLATE" description="Редактирование шаблона"  type="client">
                    <next-states default="DRAFTTEMPLATE"/>
                </event>
                <event name="SAVEASTEMPLATE" description="Сохраненить документ, как шаблон" type="client">
                    <handlers>
                        <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.DeactivateEditEventTemplateHandler"/>
                    </handlers>
                    <next-states default="SAVED_TEMPLATE"/>
                </event>
            </events>
        </state>

        <state id="SAVED_TEMPLATE" description="Вы подтвердили шаблон документа в Шаблонах платежей."
               client-form="/private/payments/template/confirm.do"
               system-resolver="com.rssl.phizic.business.payments.ERIBSystemNameResolver">

            <forms>
                <form application="PhizIC" url="/private/payments/template.do" description="Шаг редактирования шаблона платежа">
                    <filters>
                        <filter class="com.rssl.phizic.business.documents.templates.stateMachine.forms.filters.EditEventEnabledFormFilter"/>
                        <filter class="com.rssl.phizic.business.documents.templates.stateMachine.forms.filters.TemplateStateFormFilter">
                            <parameters>
                                <parameter name="states" value="DRAFTTEMPLATE"/>
                                <parameter name="invert" value="true"/>
                            </parameters>
                        </filter>
                    </filters>
                </form>
            </forms>

            <handlers>
                <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.ActivateEditEventTemplateHandler">
                    <parameter name="value" value="false"/>
                </handler>
            </handlers>

            <events>
                <event name="EDIT_TEMPLATE" description="Редактирование шаблона" type="client">
                    <next-states default="SAVED_TEMPLATE">
                        <handlers>
                            <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.ActivateEditEventTemplateHandler">
                                <parameter name="value" value="true"/>
                            </handler>
                        </handlers>
                    </next-states>
                </event>
                <event name="SAVEASTEMPLATE" description="Сохраненить документ, как шаблон" type="client">
                    <handlers>
                        <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.DeactivateEditEventTemplateHandler"/>
                    </handlers>
                    <next-states default="SAVED_TEMPLATE"/>
                </event>
                <event name="CONFIRM" description="Подтверждение шаблона" type="client">
                    <next-states default="TEMPLATE"/>
                </event>
            </events>
        </state>

		<state id="TEMPLATE" description="Вы сохранили шаблон документа в Шаблонах платежей."
			   client-form="/private/payments/template/view.do"
			   system-resolver="com.rssl.phizic.business.payments.ERIBSystemNameResolver">

            <forms>
                <form application="PhizIC" url="/private/payments/template.do" description="Шаг редактирования шаблона платежа">
                    <filters>
                        <filter class="com.rssl.phizic.business.documents.templates.stateMachine.forms.filters.EditEventEnabledFormFilter"/>
                        <filter class="com.rssl.phizic.business.documents.templates.stateMachine.forms.filters.TemplateStateFormFilter">
                            <parameters>
                                <parameter name="states" value="DRAFTTEMPLATE"/>
                                <parameter name="invert" value="true"/>
                            </parameters>
                        </filter>
                    </filters>
                </form>
            </forms>

            <handlers>
                <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.ActivateEditEventTemplateHandler">
                    <parameter name="value" value="false"/>
                </handler>
            </handlers>

            <events>
                <event name="EDIT_TEMPLATE" description="Редактирование шаблона" type="client">
                    <next-states default="TEMPLATE">
                        <handlers>
                            <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.ActivateEditEventTemplateHandler">
                                <parameter name="value" value="true"/>
                            </handler>
                        </handlers>
                    </next-states>
                </event>
                <event name="SAVEASTEMPLATE" description="Сохраненить документ, как шаблон" type="client">
                    <handlers>
                        <handler class="com.rssl.phizic.business.documents.templates.stateMachine.handlers.DeactivateEditEventTemplateHandler"/>
                    </handlers>
                    <next-states default="SAVED_TEMPLATE"/>
                </event>
			</events>
		</state>
	</states>

</config>
